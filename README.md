# Remnawave Limiter

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è Remnawave VPN —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º fail2ban**

–°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç –ª–æ–≥–∏ Remnawave –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç IP-–∞–¥—Ä–µ—Å–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π —Å –æ–¥–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –Ω–æ–¥–µ.

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç](#-–∫–∞–∫-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CLI](#%EF%B8%8F-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-cli)
- [Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è](#-webhook-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
- [Troubleshooting](#-troubleshooting)
- [FAQ](#-faq)

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **Fail2ban –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –±–∞–Ω–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞–∑–±–∞–Ω–æ–º
- ‚úÖ **–¢–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å –∫ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—é —Å–µ—Ç–∏** - –Ω–µ –±–∞–Ω–∏—Ç –ø—Ä–∏ —Å–º–µ–Ω–µ LTE‚ÜîWi-Fi –∏–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤—ã—à–µ–∫
- ‚úÖ **CLI —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - —É–¥–æ–±–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ **Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Ä–∞–∑—Ä–∞—Å—Ç–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤

## üîç –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤** - –ß–∏—Ç–∞–µ—Ç access –ª–æ–≥ Remnawave –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
2. **–°–±–æ—Ä —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP** - –î–ª—è –∫–∞–∂–¥–æ–≥–æ email —Å–æ–±–∏—Ä–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏** - IP —Å—á–∏—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º –µ—Å–ª–∏ –±—ã–ª < 60 —Å–µ–∫—É–Ω–¥ –Ω–∞–∑–∞–¥
4. **–î–µ—Ç–µ–∫—Ü–∏—è –Ω–∞—Ä—É—à–µ–Ω–∏–π** - –ï—Å–ª–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö IP > –ª–∏–º–∏—Ç–∞ ‚Üí –ª–æ–≥–∏—Ä—É–µ—Ç –Ω–∞—Ä—É—à–µ–Ω–∏–µ
5. **Fail2ban –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –ü–æ—Å–ª–µ 3 –Ω–∞—Ä—É—à–µ–Ω–∏–π –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP

### –ó–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

- **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è** - –û–¥–Ω–æ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —á–∞—â–µ —Ä–∞–∑–∞ –≤ –º–∏–Ω—É—Ç—É
- **Fail2ban tolerance** - –ù—É–∂–Ω–æ 3 –Ω–∞—Ä—É—à–µ–Ω–∏—è –∑–∞ 5 –º–∏–Ω—É—Ç –¥–ª—è –±–∞–Ω–∞
- **Grace period** - 60 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–µ—Ç–∏
- **Timestamp-based detection** - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞–ª–∏—á–∏—è –≤ –ª–æ–≥–µ

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–°**: Ubuntu 20.04+, Debian 10+, CentOS 7+, Fedora, Arch, Alpine
- **Python**: 3.8 –∏–ª–∏ –≤—ã—à–µ
- **Fail2ban**: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- **Remnanode**: –Ω–æ–¥–∞ —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º —Å access –ª–æ–≥–æ–º
- **Root –¥–æ—Å—Ç—É–ø**: –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ systemd —Å–µ—Ä–≤–∏—Å–æ–≤

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–°–∫–∞—á–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É
```bash
git clone https://github.com/syvlech/remnawave-limiter.git && cd remnawave-limiter && sudo bash install.sh
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

–£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –∑–∞–ø—Ä–æ—Å–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------------|----------|
| –ü—É—Ç—å –∫ –ª–æ–≥—É Remnawave | `/var/log/remnanode/access.log` | Access –ª–æ–≥ Remnawave |
| –ú–∞–∫—Å–∏–º—É–º IP –Ω–∞ –∫–ª—é—á | `1` | –õ–∏–º–∏—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö IP |
| –í—Ä–µ–º—è –±–∞–Ω–∞ (–º–∏–Ω—É—Ç—ã) | `30` | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ |
| –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Å–µ–∫) | `5` | –ß–∞—Å—Ç–æ—Ç–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ª–æ–≥–æ–≤ |
| –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–∞ (—Å–µ–∫) | `3600` | –ß–∞—Å—Ç–æ—Ç–∞ truncate –ª–æ–≥–∞ |
| –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ | `VPN Server` | –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ webhook |
| Webhook URL | `none` | URL –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
systemctl status remnawave-limiter
systemctl status fail2ban

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CLI
limiter status
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–§–∞–π–ª: `/opt/remnawave-limiter/.env`

```bash
# Remnawave IP Limiter Configuration

# –ü—É—Ç—å –∫ –ª–æ–≥—É Remnawave
REMNAWAVE_LOG_PATH=/var/log/remnanode/access.log

# –ü—É—Ç—å –∫ –ª–æ–≥—É –Ω–∞—Ä—É—à–µ–Ω–∏–π (–¥–ª—è fail2ban)
VIOLATION_LOG_PATH=/var/log/remnawave-limiter/access-limiter.log

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ IP-–∞–¥—Ä–µ—Å–æ–≤ –Ω–∞ –æ–¥–∏–Ω –∫–ª—é—á
MAX_IPS_PER_KEY=1

# –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
CHECK_INTERVAL=5

# –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
LOG_CLEAR_INTERVAL=3600

# Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
WEBHOOK_URL=https://your-domain.com/api/webhook
SERVER_NAME=–í–∏–ª—å–Ω—é—Å
BAN_DURATION_MINUTES=30
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Fail2ban

–§–∞–π–ª: `/etc/fail2ban/jail.d/remnawave-limiter.conf`

```ini
[remnawave-limiter]
enabled = true
backend = auto
filter = remnawave-limiter
action = remnawave-limiter
logpath = /var/log/remnawave-limiter/access-limiter.log
maxretry = 3          # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞—Ä—É—à–µ–Ω–∏–π –¥–ª—è –±–∞–Ω–∞
findtime = 300        # –û–∫–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ (5 –º–∏–Ω—É—Ç)
bantime = 30m         # –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–Ω–∞
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
# –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è .env
sudo systemctl restart remnawave-limiter

# –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è fail2ban –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo systemctl restart fail2ban
```

## üñ•Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CLI

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
limiter status

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è
limiter violations

# –°–ø–∏—Å–æ–∫ –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö IP
limiter banned

# –†–∞–∑–±–∞–Ω–∏—Ç—å IP
limiter unban 1.2.3.4
```

### –í—Å–µ –∫–æ–º–∞–Ω–¥—ã

#### `limiter status`
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ fail2ban jail:
```bash
$ limiter status
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë         Remnawave IP Limiter - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã          ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üìä –°–µ—Ä–≤–∏—Å remnawave-limiter: active
üîí Fail2ban: active

–°—Ç–∞—Ç—É—Å jail 'remnawave-limiter':
|- Filter
|  |- Currently failed: 2
|  |- Total failed:     15
|  `- File list:        /var/log/remnawave-limiter/access-limiter.log
`- Actions
   |- Currently banned: 1
   |- Total banned:     5
   `- Banned IP list:   1.2.3.4
```

#### `limiter violations [-n 20]`
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è:
```bash
$ limiter violations -n 10
üìã –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 –Ω–∞—Ä—É—à–µ–Ω–∏–π:

2025/11/28 12:00:00 ‚îÇ user@example.com ‚îÇ 1.2.3.4
2025/11/28 12:01:00 ‚îÇ user@example.com ‚îÇ 1.2.3.4
2025/11/28 12:02:00 ‚îÇ user@example.com ‚îÇ 1.2.3.4
```

#### `limiter banned`
–°–ø–∏—Å–æ–∫ –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö IP:
```bash
$ limiter banned
üö´ –ó–∞–±–∞–Ω–µ–Ω–Ω—ã–µ IP:
   ‚Ä¢ 1.2.3.4
   ‚Ä¢ 5.6.7.8
```

#### `limiter unban <ip>`
–†–∞–∑–±–∞–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π IP:
```bash
$ limiter unban 1.2.3.4
üîì –†–∞–∑–±–∞–Ω 1.2.3.4...
‚úÖ IP 1.2.3.4 —Ä–∞–∑–±–∞–Ω–µ–Ω
```

#### `limiter unban-all`
–†–∞–∑–±–∞–Ω–∏—Ç—å –≤—Å–µ IP:
```bash
$ limiter unban-all
üîì –†–∞–∑–±–∞–Ω 3 IP –∞–¥—Ä–µ—Å–æ–≤...
  ‚úì 1.2.3.4
  ‚úì 5.6.7.8
  ‚úì 9.10.11.12
‚úÖ –í—Å–µ IP —Ä–∞–∑–±–∞–Ω–µ–Ω—ã
```

#### `limiter active`
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –ª–æ–≥–∞:
```bash
$ limiter active
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë            –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—Ç–µ–∫—É—â–∏–π –ª–æ–≥)          ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üìß user1@example.com (2 IP)  # –ö—Ä–∞—Å–Ω—ã–π - –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç
   ‚îî‚îÄ 1.2.3.4
   ‚îî‚îÄ 5.6.7.8

üìß user2@example.com (1 IP)  # –ó–µ–ª–µ–Ω—ã–π - –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ª–∏–º–∏—Ç–∞
   ‚îî‚îÄ 9.10.11.12
```

#### `limiter logs [-f] [-n 50]`
–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —Å–µ—Ä–≤–∏—Å–∞:
```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
limiter logs

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
limiter logs -n 100

# –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
limiter logs -f
```

#### `limiter clear`
–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏ (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è):
```bash
$ limiter clear
‚ö†Ô∏è  –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ –ª–æ–≥–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–π –∏ Remnawave access log!
–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (yes/no): yes
‚úÖ –õ–æ–≥ –Ω–∞—Ä—É—à–µ–Ω–∏–π –æ—á–∏—â–µ–Ω
‚úÖ Access –ª–æ–≥ –æ—á–∏—â–µ–Ω
‚úÖ –°–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
```

## üì° Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –§–æ—Ä–º–∞—Ç payload

–ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ IP –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è POST –∑–∞–ø—Ä–æ—Å —Å JSON:

```json
{
  "server": "–í–∏–ª—å–Ω—é—Å",
  "ban_duration_minutes": 30,
  "ip_masked": "123.45.**.**",
  "ip_full": "123.45.67.89",
  "email": "ofgoak4kal3",
  "reason": "–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ª–æ–∫–∞—Ü–∏–∏ —Å 2 IP (–ª–∏–º–∏—Ç: 1)",
  "timestamp": "2025-11-28T12:00:00.123456",
  "active_ip_count": 2,
  "limit": 1
}
```

### –ü–æ–ª—è payload

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `server` | string | –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ (–∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞) |
| `ban_duration_minutes` | int | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–Ω–∞ –≤ –º–∏–Ω—É—Ç–∞—Ö |
| `ip_masked` | string | –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π IP (123.45.\*\*.\*\*) |
| `ip_full` | string | –ü–æ–ª–Ω—ã–π IP –∞–¥—Ä–µ—Å |
| `email` | string | Email –∫–ª—é—á–∞ |
| `reason` | string | –ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ |
| `timestamp` | string | ISO 8601 timestamp |
| `active_ip_count` | int | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö IP |
| `limit` | int | –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π –ª–∏–º–∏—Ç IP |


### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook

```bash
# –í .env —Ñ–∞–π–ª–µ
WEBHOOK_URL=https://your-domain.com/api/webhook
SERVER_NAME=–í–∏–ª—å–Ω—é—Å
BAN_DURATION_MINUTES=30

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
sudo systemctl restart remnawave-limiter
```

### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ webhook

```bash
–ø—Ä–æ—Å—Ç–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ
# WEBHOOK_URL=
```

## üîß Troubleshooting

### –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
systemctl status remnawave-limiter

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
journalctl -u remnawave-limiter -n 50 --no-pager

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã
ls -la /opt/remnawave-limiter/
ls -la /var/log/remnawave-limiter/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
cat /opt/remnawave-limiter/.env
```

### Fail2ban –Ω–µ –±–∞–Ω–∏—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å fail2ban
systemctl status fail2ban

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å jail
fail2ban-client status remnawave-limiter

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ regex —Ä–∞–±–æ—Ç–∞–µ—Ç
fail2ban-regex /var/log/remnawave-limiter/access-limiter.log \
               /etc/fail2ban/filter.d/remnawave-limiter.conf

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ fail2ban
tail -100 /var/log/fail2ban.log | grep remnawave
```

### –ù–∞—Ä—É—à–µ–Ω–∏—è –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ access –ª–æ–≥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -la /var/log/remnanode/access.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –ª–æ–≥–∞
tail -5 /var/log/remnanode/access.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª–æ–≥
journalctl -u remnawave-limiter -f

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å violations –ª–æ–≥
tail -20 /var/log/remnawave-limiter/access-limiter.log
```

### –õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Å–µ—Ç–∏

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –µ—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±—ã—Å—Ç—Ä–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
# –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ fail2ban
fail2ban-client get remnawave-limiter maxretry   # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 3
fail2ban-client get remnawave-limiter findtime   # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 300

# –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –¥—Ä—É–≥–∏–µ - –∏—Å–ø—Ä–∞–≤—å—Ç–µ –≤ –∫–æ–Ω—Ñ–∏–≥–µ
sudo nano /etc/fail2ban/jail.d/remnawave-limiter.conf
sudo systemctl restart fail2ban
```

### Webhook –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ webhook
journalctl -u remnawave-limiter | grep -i webhook

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
cat /opt/remnawave-limiter/.env | grep WEBHOOK

# –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ webhook
curl -X POST https://your-domain.com/api/webhook \
  -H 'Content-Type: application/json' \
  -d '{"server":"Test","ip_masked":"1.2.**.**"}'
```

## ‚ùì FAQ

### –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ª–∏–º–∏—Ç IP –Ω–∞ –∫–ª—é—á?

```bash
sudo nano /opt/remnawave-limiter/.env
# –ò–∑–º–µ–Ω–∏—Ç–µ MAX_IPS_PER_KEY=1 –Ω–∞ –Ω—É–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
sudo systemctl restart remnawave-limiter
```

### –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –±–∞–Ω–∞?

```bash
sudo nano /etc/fail2ban/jail.d/remnawave-limiter.conf
# –ò–∑–º–µ–Ω–∏—Ç–µ bantime = 30m –Ω–∞ –Ω—É–∂–Ω–æ–µ (m=–º–∏–Ω—É—Ç—ã, h=—á–∞—Å—ã, d=–¥–Ω–∏)
sudo systemctl restart fail2ban
```

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è?

–°–∫—Ä–∏–ø—Ç –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ —á–∞—â–µ —Ä–∞–∑–∞ –≤ –º–∏–Ω—É—Ç—É. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç:
- –ï—Å–ª–∏ IP –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç ‚Üí –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è 1 —Ä–∞–∑
- –ß–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥, –µ—Å–ª–∏ –≤—Å–µ –µ—â–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç ‚Üí –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —Å–Ω–æ–≤–∞
- –í—Å–µ–≥–æ –∑–∞ 5 –º–∏–Ω—É—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –º–∞–∫—Å–∏–º—É–º 5 –∑–∞–ø–∏—Å–µ–π Found
- –î–ª—è –±–∞–Ω–∞ –Ω—É–∂–Ω–æ 3 Found ‚Üí –º–∏–Ω–∏–º—É–º 2 –º–∏–Ω—É—Ç—ã –¥–æ –±–∞–Ω–∞

### –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö?

–î–∞! –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–∞ –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–µ—Ä –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ `SERVER_NAME`:
```bash
# –°–µ—Ä–≤–µ—Ä 1
SERVER_NAME=–í–∏–ª—å–Ω—é—Å

# –°–µ—Ä–≤–µ—Ä 2
SERVER_NAME=–ê–º—Å—Ç–µ—Ä–¥–∞–º
```

Webhook –±—É–¥–µ—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å —Å–µ—Ä–≤–µ—Ä—ã –ø–æ –ø–æ–ª—é `server`.

### –ö–∞–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç—å?

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
sudo systemctl stop remnawave-limiter
sudo systemctl disable remnawave-limiter

# –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã
sudo rm -rf /opt/remnawave-limiter
sudo rm /etc/systemd/system/remnawave-limiter.service
sudo rm /etc/fail2ban/jail.d/remnawave-limiter.conf
sudo rm /etc/fail2ban/filter.d/remnawave-limiter.conf
sudo rm /etc/fail2ban/action.d/remnawave-limiter.conf
sudo rm /usr/local/bin/limiter

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å systemd –∏ fail2ban
sudo systemctl daemon-reload
sudo systemctl restart fail2ban

# –£–¥–∞–ª–∏—Ç—å –ª–æ–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
sudo rm -rf /var/log/remnawave-limiter
```

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

Contributions are welcome! Please feel free to submit a Pull Request.

## üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Issues**: [GitHub Issues](https://github.com/syvlech/remnawave-limiter/issues)

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- –û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ [fail2ban](https://github.com/fail2ban/fail2ban)

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. [LICENSE](LICENSE)
